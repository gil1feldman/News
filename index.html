<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>הצעות חוק הכנסת ה־25</title>
  <script defer>
    document.addEventListener("DOMContentLoaded", async () => {
      const baseUrl = 'https://main.knesset.gov.il/Activity/Legislation/Laws/Pages/LawSuggestionsSearch.aspx?t=lawsuggestionssearch&st=currentknesset&ki=25&sb=LatestSessionDate&so=D&pn=';
      const lawPattern = /<tr[^>]+>[\s\S]*?data-label="מספר כנסת">([^<]+)[\s\S]*?href="([^"]+)"[^>]*>([^<]+)[\s\S]*?data-label="סוג הצעה">([^<]+)[\s\S]*?data-label="שלב">([^<]*)[\s\S]*?data-label="תאריך עדכון אחרון">([^<]*)/g;

      const output = document.getElementById("output");

      for (let pn = 1; pn <= 3; pn++) {
        const res = await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent(baseUrl + pn)}`);
        const html = await res.text();
        let match;
        while ((match = lawPattern.exec(html)) !== null) {
          const row = document.createElement("tr");
          row.className = "border-b";
          for (let i = 1; i <= 6; i++) {
            const td = document.createElement("td");
            td.className = "p-2";
            if (i === 2) {
              const link = document.createElement("a");
              link.href = "https://main.knesset.gov.il" + match[i];
              link.textContent = match[i + 1];
              link.target = "_blank";
              link.className = "text-blue-600 underline";
              td.appendChild(link);
              i++; // skip title text
            } else {
              td.textContent = match[i];
            }
            row.appendChild(td);
          }
          output.appendChild(row);
        }
      }
    });
  </script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-900 p-4 font-sans">
  <h1 class="text-2xl font-bold mb-4 text-center">הצעות חוק הכנסת ה־25 (3 עמודים ראשונים)</h1>
  <div class="overflow-x-auto">
    <table class="table-auto w-full border-collapse bg-white shadow rounded-lg">
      <thead class="bg-gray-200">
        <tr>
          <th class="p-2">כנסת</th>
          <th class="p-2">שם החוק</th>
          <th class="p-2">סוג הצעה</th>
          <th class="p-2">שלב</th>
          <th class="p-2">תאריך עדכון</th>
        </tr>
      </thead>
      <tbody id="output"></tbody>
    </table>
  </div>
</body>
</html>
